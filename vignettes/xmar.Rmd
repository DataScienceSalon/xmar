---
title: "Extra-Marital Sex: Opinions and Behaviors"
author: "John James jjames@datasciencesalon.org"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output:
  rmdformats::readthedown:
    highlight: kate
    css: rmdStyles.css
bibliography: library.bib
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r knitr_init, echo=FALSE, cache=FALSE, warning=FALSE, message=FALSE}
options(knitr.table.format = "html")
options(max.print="75", scipen=999, width = 800)
knitr::opts_chunk$set(echo=FALSE,
	             cache=FALSE,
               prompt=FALSE,
               tidy=TRUE,
               root.dir = "..",
               fig.height = 4,
               fig.width = 10,
               comment=NA,
               message=FALSE,
               warning=FALSE)
knitr::opts_knit$set(width=100, figr.prefix = T, figr.link = T)
knitr::knit_hooks$set(inline = function(x) {
  prettyNum(x, big.mark=",")
})
```

```{r loadData, cache=TRUE}
source("../inst/extdata/GSS.r")
```

# Abstract
# Introduction
## Background Information
## Research Questions
Three research questions have been devised to examine the relationship between opinion and behavior with respect to extra-marital sex, and the degree to which they vary by select demographic factors. Concretely, the following three research questions are presented, analyzed and discussed:  
1. Is there an association between opinion and behavior with respect to extra-marital sex in the United States?
2. Is there an association between opinion and geographic region, class, political view, and education level in the United States?
3. Is there an association between behavior and geographic region, class, political view, and education level in teh United States?

## Document Organization
The **methods** section describes the data, the sampling techniques, data preprocessing, and introduces the methods, descriptive and inferential techniques used in the univariate and multivariate analyses. Hypotheses are offered, analyzed and tested in the **results** section, and the **discussion** section describes the significance of the findings vis-a-vis currently available research. Lastly, the **conclusion** synthesizes the key points.

# Methods
## Data 
The General Social Survey (GSS), a project of the NORC at the University of Chicago, provided the data upon which this report is based. Formerly known as the National Opinion Research Center, "NORC at the University of Chicago is an objective non-partisan research institution that delivers reliable data and rigorous analysis to guide critical programmatic, business, and policy decisions" [@NORC]. Principally funded by the National Science Foundation, the GSS has been monitoring evolution, complexity opinions, behaviors, and attributes of American society since 1972. Targeting the adult population, age 18 and over in the United, the data covers a diverse range of issues including national spending priorities, marijuana use, crime and punishment, race relations, quality of life, confidence in institutions, and sexual behavior.

### Data Sampling Strategy
The GSS employed a multi-stage area full probability sampling strategy. 

At the first stage, NORC employed the Standard Metropolitan Statistical Areas (SMSAs) or non-metropolitan counties selected in NORC's Master Sample, as the Primary Sampling Unit (PSU). These were further subdvided into three categories. Category 1, representing 56% of the US population, comprised of the nations largest metropolitan areas or Consolidated Statistical Areas (CSAs) with a population of at least 1,543,728 (0.5 percent of the 2010 Census U.S. population). The second category, covering 35% of the US population, included Core Based Statistical Areas and CSAs with at least 8 tracts that are predominantly street-style addresses.  The third category spanned 9% of the US population and consisted of small counties with at most 8 tracts. Minimum size for tracts were defined as 300 respondents.

Similarly, the second stage sampling was conducted in three categories. Category 1 comprised 216 type A tracts (city addresses) and 8 block-groups within type B (rural) tracts. Category 2, consisted of 8 segments per first-stage selection resulted in 480 segments in the 2010 National Sample Design, but GSS used only 120 of them. For category 3 first-stage selections, the 2010 National Sample Design only selected 5 segments per first-stage selection, but GSS used 4 and one half of them for a total of 56 segments.  

The sampling strategy employed by GSS was designed to give each household an equal probability of being included in the sample. For each household selected, sampling procedures were undertaken to ensure that each individual in that household had an equal probability of being interviewed. 

### Data Sampling Bias
The GSS samples closely resemble distributions reported in the Census and other authoritative sources. However, survey non-response, sampling variation, and various other factors have introduced potential sources of bias and resulted in variance from Census distributions on some variables. For instance all full-probability samples under-represent males and block quota samples under-represented men in full-time employment. Weights were designed (and should be employed when using GSS 2004 or later), to assure proper representation of non-response sub-samples, and other factors. For a full discussion of distributional variation due to non-response, one should refer to the GSS Methodological Reports in the help and resources section at https://gssdataexplorer.norc.org/,

This full probability design was acknowledged by the National Science Foundation to be superior to simple random sampling, and **generalizable** to the population of adult citizens in America.  Consisting of over 60,000 individual responses, spanning over 40 years, the GSS data remains one of the nations treasures, providing data for inference about American society to researchers, academics, students, politicians, and opinion makers.  Yet, as respondents were randomly selected (not assigned), one is careful to limit inferences to **association, and not causation.**  That said, the extent to which results of a research question can be generalized to the population will require that the inference conditions are met, specifically the proportion success/failure condition. As such, the question of "generalizeability" will need to be re-addressed independently for each research question.

### Data Variables
The following table lists the variables used in and created for, this analysis.

`r kfigr::figr(label = "variableTbl", prefix = TRUE, link = TRUE, type="Table")`: GSS and Derived Variables Used in Study 
```{r variableTbl, echo = F, message = FALSE, warning=FALSE}
variables <- read.csv("../data/variables.csv")
knitr::kable(variables) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center")
```

### Data Preprocessing
The GSS variables were extracted for years 2010 thru 2016. Data sets containing individual proportions were created. Responses with "NAs", "Don't Know", and other non-response values for the GSS variables in scope, were filtered from the data set. The degree to which the results of this analysis are generalizable to the population of American adults age 18 and over, is largely dependent upon the the representativeness of the sample. Since multiple categorical variables were used, each with different completion rates, a priori sample size analysis was conducted for each categorical variable.

```{r preprocess, cache=TRUE}
xmar <- preprocess(GSS)
```

### Sample Size Analysis
In this sample size analysis, null proportions and their associated standard errors were calculated for each grouping variable. The following summarizes the minimum sample sizes required to be 95% confidence that the sample proportions were within a 5% margin of error of the population proportions.

`r kfigr::figr(label = "sampleSizeTable", prefix = TRUE, link = TRUE, type="Table")`: Sample Size Analysis
```{r sampleSizeTable, echo = F, message = FALSE, warning=FALSE}
sampleSize <- sampleSize(xmar)
knitr::kable(sampleSize) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center")
```

`r kfigr::figr(label = "sampleSizeTable", prefix = TRUE, link = TRUE, type="Table")` shows that the sample size is large enough to support the inferences that generalize to the population. Specifically, one can assume that with 95% confidence that the sample proportions are within a 5% margin of error of the population proportions.

## Data Analysis
The study involved both descriptive and inferential statistics. Descriptive statistics describe each of the variables within the scope of this study; whereas, the inferential statistics characterize relationships between the categorical variables.

### Descriptive Statistics
For each variable of interest, proportions and frequency counts were calculated and presented in tables and bar plots. Confidence intervals for the population proporations were estimated using sample proportions and standard errors with a 95% confidence as follows:

$$95\% CI = \hat{p}  \pm z^{*}SE_{\hat{p}}$$
where: $\hat{p}$ is the point estimate for the proportion, $z^{*} = 1.96$, the 95% critical value and:
$$SE_{\hat{p}} = \sqrt{(\frac{\hat{p}(1-\hat{p})}{n})}$$
**Bootstrapping** was used to visualize the sampling distribution of proportions. Since *independence* and *success/failure conditions* were met, normal distributions of the sample proportions $X \approx N(\mu, \sigma^2)$ were simulated, where $X$ was the sample proportion, a normally distributed random variable, $\mu$ was estimated using the sample proportion $\hat{p}$ and $\sigma^2$ was estimated using the sample proportion standard error, $SE_{\hat{p}}$. The simulation was repeated 10,000 times and plots provided visual depictions of the population proportions.

### Inferential Statistics
To evaluate the association between opinions, behaviors and demographic variables, contingency tables and bar plots were rendered and chi-square ($X^2$) tests of independence were performed to determine the association between the variables. The $X^2$ distribution with $k$ degrees of freedom is the distribution of a sum of the squares of $k$ independent standard normal random variables, in this case, a *target* or study variable and a *grouping* variable. The $X^2$ test statistic is computed as follows:
$$X^2 = \displaystyle\sum_{i=1}^{n} \frac{(O_i - E_i)^2}{E_i}$$
where:  
  $X^2 = $Pearson's cumulative test statistic.  
  $O_i = $the number of observations of type $i$.  
  $E_i = $the expected (theoretical) frequency of type $i$, asserted by the null hypothesis that the fraction of type $i$ in the population is $p_i = \frac{1}{l}$, where $l$ is the number of levels for the categorical variable.  
  $n = $the number of cells in the contingency table.  
  
The results were tabulated and chi-square distributions, showing the rejection zone and test statistic, were plotted. Pairwise, two-sided, two-proportion hypothesis tests were performed to determine the statistical significance of the differences between selected proportions. Concretely, the following hypotheses were tested.  
  $H_0: \hat{p_1} = \hat{p_2}$  
  $H_a: \hat{p_1} \ne \hat{p_2}$  
such that:  
$$Z = \frac{(\hat{p_1} - \hat{p_2}) - 0}{SE_{pooled}}$$  
where:  
$$SE_{pooled} = \sqrt{\frac{\hat{p}(1-\hat{p})}{n_1} + \frac{\hat{p}(1-\hat{p})}{n_2}}$$  
where:  
$$\hat{p} = \frac{\hat{p_1}n_1 + \hat{p_2}n_2}{n_1 + n_2}$$  

The $\alpha$ significance level was uniformly set to $\alpha = 0.05$ for all statistical tests, except for the pair-wise two-proportion tests. Multiple z-tests increase the chances of a type 1 error.  To counter this, the **Bonferroni Correction** was applied to the significance level, whereby $\alpha_{bc} = \alpha / correction$. where:  

$correction = \frac{k(k - 1)}{2}$, and
$k = $the number of comparisons.

## System and Environment
This analysis was implemented using the 64 bit version of the R Programming Language, version 3.4.1. [@TheRFoundation2015] within the R. Studio Version 1.1.330 [@RStudioTeam2016] development environment on a Windows x64-based laptop powered by an Intel Core i7-3610QM CPU @ 2.30GHz, 2301 MHz processor with 4 Cores, 8 Logical Processors, and 16.0 GB of installed memory, running the Microsoft Windows 10 Home operating system, version	10.0.14393 Build 14393. Report writing and generation packages included knitr [@Xie2013], and kfigr [@Koohafkan2015].  Data management functionality was provided by the dplyr [Wickham2015a], reshape2 [@Rcpp2016], xtable [@Dahl2016] and data table [@Dowle2016] packages. Graphics and data visualization were powered by the ggplot2 [@Wickham2016], gridExtra [@BaptisteAuguie2016], and the stargazer [@Hlavac2015] packages.  The inference [@VinhNguyen2017] statistcal package provided functionality for extracting inferential values from a fitted model.

# Results  
## Univariate Analysis  
The univariate analysis examines each variable and reports their sample proportions, as well as the 95% confidence intervals for the population proportions. Plots depicting the estimated distribution of population proportions were rendered. `r kfigr::figr(label = "univariateSummary", prefix = TRUE, link = TRUE, type="Table")` summarizes the variables examined in the analysis, in terms of their categorical levels, complete and NA cases, and complete response rates.  

`r kfigr::figr(label = "univariateSummary", prefix = TRUE, link = TRUE, type="Table")`: Variable Summary
```{r univariateSummary, echo = F, message = FALSE, warning=FALSE}
uni <- univariate(xmar)
knitr::kable(uni$summary) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center")
```

Next, the sample proportions are examined, population proportions estimated, and confidence intervals computed.

### Region
As shown in `r kfigr::figr(label = "regionData", prefix = TRUE, link = TRUE, type="Table")`, the `r sum(uni$region$data$N)` responses were distributed among `r nrow(uni$region$data)` regions, ranging from `r min(uni$region$data$N)`, to `r max(uni$region$data$N)` complete cases. Since the independence and success/failure criteria were met, 95% confidence intervals for the population proportions were estimated as indicated below.

`r kfigr::figr(label = "regionData", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Responses by Region
```{r regionData, include=T, echo = F, results='html'}
knitr::kable(uni$region$data, digits = c(0,0,2,2,3,3,5)) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 

`r kfigr::figr(label = "regionBarPlot", prefix = TRUE, link = TRUE, type="Figure")` graphically depicts the sample **proportions** of responses by region. The mid-west accounts for approximately `r round(sum(uni$region$data$Proportion[4], uni$region$data$Proportion[5]) * 100, 0)`% of all responses. The Atlantic states stood for `r round(sum(uni$region$data$Proportion[1], uni$region$data$Proportion[2], uni$region$data$Proportion[3]) * 100, 0)`% of the data, mountain and pacific states, `r round(sum(uni$region$data$Proportion[6], uni$region$data$Proportion[7]) * 100, 0)`%.

```{r regionBarPlot, include=T, echo = F, results='html'}
uni$region$barPlot
``` 
`r kfigr::figr(label = "regionBarPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Responses by Region

Using the **bootstrap** method, a sampling distribution of proporations was simulated based upon the sample proportions and standard errors. Depicted in `r kfigr::figr(label = "regionDensityPlot", prefix = TRUE, link = TRUE, type="Figure")`,  

```{r regionDensityPlot, include=T, echo = F, results='html'}
uni$region$densityPlot
``` 
`r kfigr::figr(label = "regionDensityPlot", prefix = TRUE, link = TRUE, type="Figure")`: Simulated Sampling Distribution of Proportions. Since the independence and success/failure criteria were met, one could infer that the population proportions are  within a 5% margin of error of the sample proportions, with 95% confidence. Moreover, one could estimate the statistical significance of the differences in proportions by inspecting the overlap (or lack thereof) between the sampling distributions.


### Political Views
There were `r uni$summary$Complete[3]` (`r uni$summary$Rate[3]`) compete cases, where a plurality (`r uni$summary$Proportion[2] * 100`%)of repondents identified as "Moderate", `r uni$summary$Proportion[3] * 100`% held conservative views and `r uni$summary$Proportion[1] * 100`% considered themselves liberal. Since conditions of independence and normality were met, non-overlapping confidence intervals indicate that the differences in proportions were significant.

`r kfigr::figr(label = "viewsData", prefix = TRUE, link = TRUE, type="Table")`: Frequency and Proportion of Responses by Political View
```{r viewsData, include=T, echo = F, results='html'}
knitr::kable(uni$views$data, digits = c(0,0,2,2,3,3,5)) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 

The bar plot below graphically presents the proportions and `r kfigr::figr(label = "viewsDensityPlot", prefix = TRUE, link = TRUE, type="Figure")` reveals the simulated sampling distribution of the proportions. 

```{r viewsBarPlot, include=T, echo = F, results='html'}
uni$views$barPlot
``` 
`r kfigr::figr(label = "viewsBarPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Responses by Political View

```{r viewsDensityPlot, include=T, echo = F, results='html'}
uni$views$densityPlot
``` 
`r kfigr::figr(label = "viewsDensityPlot", prefix = TRUE, link = TRUE, type="Figure")`: Simulated Sampling Distribution of Proportions by Political View

### Class

`r kfigr::figr(label = "classData", prefix = TRUE, link = TRUE, type="Table")`: Frequency and Proportion of Responses by Class
```{r classData, include=T, echo = F, results='html'}
knitr::kable(uni$class$data, digits = c(0,0,2,2,3,3,5)) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 


```{r classBarPlot, include=T, echo = F, results='html'}
uni$class$barPlot
``` 
`r kfigr::figr(label = "degreeBarPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Responses by Class

```{r classDensityPlot, include=T, echo = F, results='html'}
uni$class$densityPlot
``` 
`r kfigr::figr(label = "degreeDensityPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Responses by Class

### Education
With a nearly 100% complete case rate of `r uni$summary$Total[1]` independent samples, one may assert that 95% of the population proportions lie within the confidence intervals indicated in `r kfigr::figr(label = "degreeData", prefix = TRUE, link = TRUE, type="Table")`.

`r kfigr::figr(label = "degreeData", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Responses by Highest Degree Attained
```{r degreeData, include=T, echo = F, results='html'}
knitr::kable(uni$degree$data, digits = c(0,0,2,2,3,3,5)) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 

```{r degreeBarPlot, include=T, echo = F, results='html'}
uni$degree$barPlot
``` 
`r kfigr::figr(label = "degreeBarPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Responses by Highest Degree Attained

```{r degreeDensityPlot, include=T, echo = F, results='html'}
uni$degree$densityPlot
``` 
`r kfigr::figr(label = "degreeDensityPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Responses by Highest Degree Attained

### Extra-Marital Sex Opinions 

`r kfigr::figr(label = "opinionData", prefix = TRUE, link = TRUE, type="Table")`: Frequency Proportion of Responses by Opinions regarding Extra Marital Sex
```{r opinionData, include=T, echo = F, results='html'}
knitr::kable(uni$opinions$data) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 

```{r opinionBarPlot, include=T, echo = F, results='html'}
uni$opinions$barPlot
``` 
`r kfigr::figr(label = "opinionBarPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Responses by Opinions regarding Extra Marital Sex 

```{r opinionDensityPlot, include=T, echo = F, results='html'}
uni$opinions$densityPlot
``` 
`r kfigr::figr(label = "opinionDensityPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Responses by Opinions regarding Extra Marital Sex 

### Extra-Marital Sex Behaviors

`r kfigr::figr(label = "behaviorData", prefix = TRUE, link = TRUE, type="Table")`: Frequency and Proportion of Respondents Who Have Engaged in Extra-Marital Sex
```{r behaviorData, include=T, echo = F, results='html'}
knitr::kable(uni$behavior$data) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 

```{r behaviorBarPlot, include=T, echo = F, results='html'}
uni$behavior$barPlot
``` 
`r kfigr::figr(label = "behaviorBarPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Respondents Who Have Engaged in Extra-Marital Sex

```{r behaviorDensityPlot, include=T, echo = F, results='html'}
uni$behavior$densityPlot
``` 
`r kfigr::figr(label = "behaviorDensityPlot", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Respondents Who Have Engaged in Extra-Marital Sex

## Research Question 1: Opinions and Behaviors
```{r rq1, cache=TRUE}
rq1Data <- rq1(xmar)
```

The degree to which opinions are aligned with behaviors is the focus of this first inquiry. More formally stated, we pose the following question:

> Is there an association between opinions and behaviors with respect to extra-marital sex?

The hypotheses are stated as follows:  
$H_0:$ Opinions and behaviors with respect to extra-marital sex are **not** associated.  
$H_a:$ Opinions and behaviors with respect to extra-marital sex **are** associated.  

<center>
`r kfigr::figr("rq1Freq", prefix = TRUE,  link = TRUE, type = "Table")`: Opinions and Beliefs Contingency Table
```{r rq1Freq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq1Data$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html')
``` 
</center>

```{r rq1Plot, include=T, echo = F, results='html'}
rq1Data$plots$prop
``` 
`r kfigr::figr(label = "rq1Plot", prefix = TRUE, link = TRUE, type="Figure")`: Opinions by Behavior Proportions

`r kfigr::figr(label = "rq1TestTable", prefix = TRUE, link = TRUE, type="Table")`: Frequency Proportion of Responses by Opinions regarding Extra Marital Sex
```{r rq1TestTable, include=T, echo = F, results='html'}
knitr::kable(rq1Data$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 


```{r rq1TestPlot, include=T, echo = F, results='html'}
rq1Data$test$distribution
``` 
`r kfigr::figr(label = "rq1TestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-square Test for Independence of Opinions and Behaviors

## Research Question 2:

```{r rq2, cache=TRUE}
rq2Data <- rq2(xmar)
```

### Opinions by Region
<center>
`r kfigr::figr(label = "rq2RegionFreq", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Opinions by Region
```{r rq2RegionFreq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq2Data$region$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html') 
``` 
</center>

```{r rq2RegionProp, include=T, echo = F, results='html'}
rq2Data$region$plots$propBar
``` 
`r kfigr::figr(label = "rq2RegionProp", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Opinions by Region

```{r rq2RegionTestPlot, include=T, echo = F, results='html'}
rq2Data$region$test$plot
``` 
`r kfigr::figr(label = "rq2RegionTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Test of the Independence of Opinion and Geographic Region

`r kfigr::figr(label = "rq2RegionTestTable", prefix = TRUE, link = TRUE, type="Table")`: Chi-Square Test of the Independence of Opinion and Geographic Region
```{r rq2RegionTestTable, include=T, echo = F, results='html'}
knitr::kable(rq2Data$region$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 


### Opinions by Political Views

<center>
`r kfigr::figr(label = "rq2ViewsFreq", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Opinions by Views
```{r rq2ViewsFreq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq2Data$views$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html') 
``` 
</center>

```{r rq2ViewsProp, include=T, echo = F, results='html'}
rq2Data$views$plots$propBar
``` 
`r kfigr::figr(label = "rq2ViewsProp", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Opinions by Views

```{r rq2ViewsTestPlot, include=T, echo = F, results='html'}
rq2Data$views$test$plot
``` 
`r kfigr::figr(label = "rq2ViewsTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Test of the Independence of Opinion and Geographic Views

`r kfigr::figr(label = "rq2ViewsTestTable", prefix = TRUE, link = TRUE, type="Table")`: Chi-Square Test of the Independence of Opinion and Geographic Views
```{r rq2ViewsTestTable, include=T, echo = F, results='html'}
knitr::kable(rq2Data$views$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 




### Opinions by Class


<center>
`r kfigr::figr(label = "rq2ClassFreq", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Opinions by Class
```{r rq2ClassFreq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq2Data$class$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html') 
``` 
</center>

```{r rq2ClassProp, include=T, echo = F, results='html'}
rq2Data$class$plots$propBar
``` 
`r kfigr::figr(label = "rq2ClassProp", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Opinions by Class

```{r rq2ClassTestPlot, include=T, echo = F, results='html'}
rq2Data$class$test$plot
``` 
`r kfigr::figr(label = "rq2ClassTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Test of the Independence of Opinion and Geographic Class

`r kfigr::figr(label = "rq2ClassTestTable", prefix = TRUE, link = TRUE, type="Table")`: Chi-Square Test of the Independence of Opinion and Geographic Class
```{r rq2ClassTestTable, include=T, echo = F, results='html'}
knitr::kable(rq2Data$class$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 

### Opinions by Degree


<center>
`r kfigr::figr(label = "rq2DegreeFreq", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Opinions by Degree
```{r rq2DegreeFreq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq2Data$degree$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html') 
``` 
</center>

```{r rq2DegreeProp, include=T, echo = F, results='html'}
rq2Data$degree$plots$propBar
``` 
`r kfigr::figr(label = "rq2DegreeProp", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Opinions by Degree

```{r rq2DegreeTestPlot, include=T, echo = F, results='html'}
rq2Data$degree$test$plot
``` 
`r kfigr::figr(label = "rq2DegreeTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Test of the Independence of Opinion and Geographic Degree

`r kfigr::figr(label = "rq2DegreeTestTable", prefix = TRUE, link = TRUE, type="Table")`: Chi-Square Test of the Independence of Opinion and Geographic Degree
```{r rq2DegreeTestTable, include=T, echo = F, results='html'}
knitr::kable(rq2Data$degree$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 


## Research Question 3:


```{r rq3, cache=TRUE}
rq3Data <- rq3(xmar)
```

### Behaviors by Region
<center>
`r kfigr::figr(label = "rq3RegionFreq", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Behaviors by Region
```{r rq3RegionFreq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq3Data$region$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html') 
``` 
</center>

```{r rq3RegionProp, include=T, echo = F, results='html'}
rq3Data$region$plots$propBar
``` 
`r kfigr::figr(label = "rq3RegionProp", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Behaviors by Region

```{r rq3RegionTestPlot, include=T, echo = F, results='html'}
rq3Data$region$test$plot
``` 
`r kfigr::figr(label = "rq3RegionTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Test of the Independence of Behavior and Geographic Region

`r kfigr::figr(label = "rq3RegionTestTable", prefix = TRUE, link = TRUE, type="Table")`: Chi-Square Test of the Independence of Behavior and Geographic Region
```{r rq3RegionTestTable, include=T, echo = F, results='html'}
knitr::kable(rq3Data$region$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 


### Behaviors by Political Views

<center>
`r kfigr::figr(label = "rq3ViewsFreq", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Behaviors by Views
```{r rq3ViewsFreq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq3Data$views$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html') 
``` 
</center>

```{r rq3ViewsProp, include=T, echo = F, results='html'}
rq3Data$views$plots$propBar
``` 
`r kfigr::figr(label = "rq3ViewsProp", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Behaviors by Views

```{r rq3ViewsTestPlot, include=T, echo = F, results='html'}
rq3Data$views$test$plot
``` 
`r kfigr::figr(label = "rq3ViewsTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Test of the Independence of Behavior and Geographic Views

`r kfigr::figr(label = "rq3ViewsTestTable", prefix = TRUE, link = TRUE, type="Table")`: Chi-Square Test of the Independence of Behavior and Geographic Views
```{r rq3ViewsTestTable, include=T, echo = F, results='html'}
knitr::kable(rq3Data$views$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 




### Behaviors by Class


<center>
`r kfigr::figr(label = "rq3ClassFreq", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Behaviors by Class
```{r rq3ClassFreq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq3Data$class$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html') 
``` 
</center>

```{r rq3ClassProp, include=T, echo = F, results='html'}
rq3Data$class$plots$propBar
``` 
`r kfigr::figr(label = "rq3ClassProp", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Behaviors by Class

```{r rq3ClassTestPlot, include=T, echo = F, results='html'}
rq3Data$class$test$plot
``` 
`r kfigr::figr(label = "rq3ClassTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Test of the Independence of Behavior and Geographic Class

`r kfigr::figr(label = "rq3ClassTestTable", prefix = TRUE, link = TRUE, type="Table")`: Chi-Square Test of the Independence of Behavior and Geographic Class
```{r rq3ClassTestTable, include=T, echo = F, results='html'}
knitr::kable(rq3Data$class$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 

### Behaviors by Degree


<center>
`r kfigr::figr(label = "rq3DegreeFreq", prefix = TRUE, link = TRUE, type="Table")`: Frequency of Behaviors by Degree
```{r rq3DegreeFreq, include=T, echo = F, results='asis'}
stargazer::stargazer(format(rq3Data$degree$data$freqTbl, quote = FALSE, justify = "right", big.mark = ","), type = 'html') 
``` 
</center>

```{r rq3DegreeProp, include=T, echo = F, results='html'}
rq3Data$degree$plots$propBar
``` 
`r kfigr::figr(label = "rq3DegreeProp", prefix = TRUE, link = TRUE, type="Figure")`: Proportion of Behaviors by Degree

```{r rq3DegreeTestPlot, include=T, echo = F, results='html'}
rq3Data$degree$test$plot
``` 
`r kfigr::figr(label = "rq3DegreeTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Test of the Independence of Behavior and Geographic Degree

`r kfigr::figr(label = "rq3DegreeTestTable", prefix = TRUE, link = TRUE, type="Table")`: Chi-Square Test of the Independence of Behavior and Geographic Degree
```{r rq3DegreeTestTable, include=T, echo = F, results='html'}
knitr::kable(rq3Data$degree$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center") 
``` 


# Discussion
# Conclusion
# Appendix
# References
