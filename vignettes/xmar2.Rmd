---
title: "Extra-Marital Sex: Opinions and Behaviors"
author: "John James jjames@datasciencesalon.org"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output:
  rmdformats::readthedown:
    highlight: kate
    css: rmdStyles.css
bibliography: library.bib
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---


```{r knitr_init, echo=FALSE, cache=FALSE, warning=FALSE, message=FALSE}
options(knitr.table.format = "html")
options(max.print="75", scipen=999, width = 800)
knitr::opts_chunk$set(echo=FALSE,
	             cache=FALSE,
               prompt=FALSE,
               tidy=TRUE,
               root.dir = "..",
               fig.height = 8,
               fig.width = 20,
               comment=NA,
               message=FALSE,
               warning=FALSE)
knitr::opts_knit$set(width=100, figr.prefix = T, figr.link = T)
knitr::knit_hooks$set(inline = function(x) {
  prettyNum(x, big.mark=",")
})
```

```{r loadData, cache=TRUE}
load(file = "../data/GSS.Rdata")
```

```{r preprocess, cache=TRUE}
xmar <- preprocess(GSS)
```

```{r univariate, echo = F, message = FALSE, warning=FALSE}
uni <- univariate(xmar)
```

```{r rq1a, echo = F, message = FALSE, warning=FALSE}
rq1aData <- rq1a(xmar)
```

```{r rq1b, echo = F, message = FALSE, warning=FALSE}
rq1bData <- rq1b(rq1aData)
```

```{r rq2, echo = F, message = FALSE, warning=FALSE}
rq2Data <- rq2(xmar)
```

```{r rq3, echo = F, message = FALSE, warning=FALSE}
rq3Data <- rq3(xmar)
```


# Abstract
# Introduction
## Background Information
## Research Questions
Three research questions have been devised to examine the relationship between opinion and behavior with respect to extra-marital sex, and the degree to which they vary by select demographic factors. Concretely, the following three research questions are presented, analyzed and discussed:  
1.  Is there an association between opinion and behavior with respect to extra-marital sex in the United States?  
2.  Is there an association between opinion and geographic region, class, political view, and education level in the United States?  
3.  Is there an association between behavior and geographic region, class, political view, and education level in teh United States?  

## Document Organization
The **methods** section describes the data, the sampling techniques, data preprocessing, and introduces the methods, descriptive and inferential techniques used in the univariate and multivariate analyses. Hypotheses are offered, analyzed and tested in the **results** section, and the **discussion** section describes the significance of the findings vis-a-vis currently available research. Lastly, the **conclusion** synthesizes the key points.

# Methods
## Data 
The General Social Survey (GSS), a project of the NORC at the University of Chicago, provided the data upon which this report is based. Formerly known as the National Opinion Research Center, "NORC at the University of Chicago is an objective non-partisan research institution that delivers reliable data and rigorous analysis to guide critical programmatic, business, and policy decisions" [@NORC]. Principally funded by the National Science Foundation, the GSS has been monitoring evolution, complexity opinions, behaviors, and attributes of American society since 1972. Targeting the adult population, age 18 and over in the United, the data covers a diverse range of issues including national spending priorities, marijuana use, crime and punishment, race relations, quality of life, confidence in institutions, and sexual behavior.

### Data Sampling Strategy
The GSS employed a multi-stage area full probability sampling strategy. 

At the first stage, NORC employed the Standard Metropolitan Statistical Areas (SMSAs) or non-metropolitan counties selected in NORC's Master Sample, as the Primary Sampling Unit (PSU). These were further subdvided into three categories. Category 1, representing 56% of the US population, comprised of the nations largest metropolitan areas or Consolidated Statistical Areas (CSAs) with a population of at least 1,543,728 (0.5 percent of the 2010 Census U.S. population). The second category, covering 35% of the US population, included Core Based Statistical Areas and CSAs with at least 8 tracts that are predominantly street-style addresses.  The third category spanned 9% of the US population and consisted of small counties with at most 8 tracts. Minimum size for tracts were defined as 300 respondents.

Similarly, the second stage sampling was conducted in three categories. Category 1 comprised 216 type A tracts (city addresses) and 8 block-groups within type B (rural) tracts. Category 2, consisted of 8 segments per first-stage selection resulted in 480 segments in the 2010 National Sample Design, but GSS used only 120 of them. For category 3 first-stage selections, the 2010 National Sample Design only selected 5 segments per first-stage selection, but GSS used 4 and one half of them for a total of 56 segments.  

The sampling strategy employed by GSS was designed to give each household an equal probability of being included in the sample. For each household selected, sampling procedures were undertaken to ensure that each individual in that household had an equal probability of being interviewed. 

### Data Sampling Bias
The GSS samples closely resemble distributions reported in the Census and other authoritative sources. However, survey non-response, sampling variation, and various other factors have introduced potential sources of bias and resulted in variance from Census distributions on some variables. For instance all full-probability samples under-represent males and block quota samples under-represented men in full-time employment. Weights were designed (and should be employed when using GSS 2004 or later), to assure proper representation of non-response sub-samples, and other factors. For a full discussion of distributional variation due to non-response, one should refer to the GSS Methodological Reports in the help and resources section at https://gssdataexplorer.norc.org/,

This full probability design was acknowledged by the National Science Foundation to be superior to simple random sampling, and **generalizable** to the population of adult citizens in America.  Consisting of over 60,000 individual responses, spanning over 40 years, the GSS data remains one of the nations treasures, providing data for inference about American society to researchers, academics, students, politicians, and opinion makers.  Yet, as respondents were randomly selected (not assigned), one is careful to limit inferences to **association, and not causation.**  That said, the extent to which results of a research question can be generalized to the population will require that the inference conditions are met, specifically the proportion success/failure condition. As such, the question of "generalizeability" will need to be re-addressed independently for each research question.

### Data Variables
The following table lists the variables used in and created for, this analysis.

`r kfigr::figr(label = "variableTbl", prefix = TRUE, link = TRUE, type="Table")`: GSS and Derived Variables Used in Study 
```{r variableTbl, echo = F, message = FALSE, warning=FALSE}
variables <- read.csv("../data/variables.csv")
knitr::kable(variables) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center")
```

### Data Preprocessing
The GSS variables were extracted for years 2010 thru 2016. Data sets containing individual proportions were created. Responses with "NAs", "Don't Know", and other non-response values for the GSS variables in scope, were filtered from the data set. The degree to which the results of this analysis are generalizable to the population of American adults age 18 and over, is largely dependent upon the the representativeness of the sample. Since multiple categorical variables were used, each with different completion rates, a priori sample size analysis was conducted for each categorical variable.

### Sample Size Analysis
In this sample size analysis, null proportions and their associated standard errors were calculated for each grouping variable. The following summarizes the minimum sample sizes required to be 95% confidence that the sample proportions were within a 5% margin of error of the population proportions.

`r kfigr::figr(label = "sampleSizeTable", prefix = TRUE, link = TRUE, type="Table")`: Sample Size Analysis
```{r sampleSizeTable, echo = F, message = FALSE, warning=FALSE}
sampleSize <- sampleSize(xmar)
knitr::kable(sampleSize) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = F, position = "center")
```

`r kfigr::figr(label = "sampleSizeTable", prefix = TRUE, link = TRUE, type="Table")` shows that the sample size is large enough to support the inferences that generalize to the population. Specifically, one can assume that with 95% confidence that the sample proportions are within a 5% margin of error of the population proportions.

## Data Analysis
The data analysis outlined in the results section of this paper follows the following hypothesis testing approach:  
1. State Hypotheses  
2. Select appropriate hypothesis test / test statistic  
3. Check Parametric Inference Conditions  
4. Compute the p-value, the probability of observing the data given the null hypothesis  
5. Interpret and report results.  

### State Hypotheses
Two types of hypothesis tests were conducted during this analysis; tests for independence and tests for differences in proportions.  

Hypothesis tests for independence of categorical variables takes the form:   
$H_0$ The two categorical variables are independent, e.g. expected counts $E$ and observed counts $O$ are equal.  
$H_a$ The two categorical variables are **not** independent, e.g. expected counts $E$ and observed counts $O$ are **not** equal.  

Tests for differences in proportions takes the following form:  
$H_0$ All proportions are equal, e.g. $p_1 = p_2 = ...= p_n$   
$H_a$ At least one proportion is statistically different from the others.  

### Test Statistics
Three types of tests were used to evaluate the hypotheses statements:   
1. One-proportion z-tests to compute confidence intervals for population proportions.  
2. Two-proportion z-tests to evaluate the difference between two proportions.   
3. Pearson's chi-square test of independence for evaluating the association between categorical variables.   

#### One proportion z-test
One sample proportion z-tests were conducted to compute the confidence intervals for the population proportions as where:
$$\hat{p} – z_{\frac{\alpha}{2}} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} \le p \le \hat{p}  + z_{\frac{\alpha}{2}}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}$$
where:  
$p$ is the population proportion of interest  
$\hat{p}$ is the sample proportion of interest  
$\alpha$ is the probability of a type I error  
$z_{\frac{\alpha}{2}}$ is the number of standard errors from the sample mean  


#### Two proportion z-test  
Pairwise, two-sided, two-proportion z-tests were performed to determine if a statistically significant difference was extant between two proportions.  Concretely, hypotheses were of the following form.  
  $H_0: p_1 = p_2$   
  $H_a: p_1 \ne p_2$    
As such, the test statistic is:  
$$Z = \frac{(\hat{p_1} - \hat{p_2}) - 0}{SE_{pooled}}$$  
where $\hat{p_1}$ and $\hat{p_2}$ are proportions from each sample and  

$$SE_{pooled} = \sqrt{\frac{\hat{p}(1-\hat{p})}{n_1} + \frac{\hat{p}(1-\hat{p})}{n_2}}$$  
and:  
$$\hat{p} = \frac{\hat{p_1}n_1 + \hat{p_2}n_2}{n_1 + n_2}$$  

#### Chi-square test of independence  
To evaluate the association between opinions, behaviors and demographic variables, Pearson’s chi-square $X^2$ test of independence was employed to compute the probability of observing differences in proportions as extreme as the differences observed, assuming the null hypothesis. The $X^2$ distribution with $k$ degrees of freedom is the distribution of a sum of the squares of $k$ independent standard normal random variables, in this case, a *target* or study variable and a *grouping* variable. The $X^2$ test statistic is computed as follows:
$$X^2 = \displaystyle\sum_{i=1}^{n} \frac{(O_i - E_i)^2}{E_i}$$
where:  
  $X^2 = $ Pearson's cumulative test statistic.  
  $O_i = $ the number of observations of type $i$.  
  $E_i = $ the expected (theoretical) frequency of type $i$, asserted by the null hypothesis that the fraction of type $i$ in the population is $p_i = \frac{1}{l}$, where $l$ is the number of levels for the categorical variable.  
  $n = $ the number of cells in the contingency table.  

### Inference Conditions
Statistical inferences were derived from parametric statistics and the central limit theoreom, whereby the former assumes that sample data comes from a population distribution with a fixed set of parameters, and the later assumes that the distribution is normal and that the parameters are $N(\mu, \sigma^2)$, where $\mu$ is the population proportion parameter $\hat{p}$ and $\sigma^2$ is the variation of of the population proportion parameter. We can assume that the sample comes from a normally distributed population if:  
1. **Independence:** The sample observations must be independent,  
2. **Success/Failure:** There are at least 10 successes and 10 failures for dichotomous categorical variables.  
3. **Sample Size:** The sample size must be less than 10% of the population, if drawn without replacement.  
3. **Expected Values:** For multiple groups or for categorical variables with multiple levels (>2), the *expected* counts must be greater than five for each variable and level.   

#### Interpret and Report Results
Results were interpreted in terms of whether the null hypothesis was rejected or not as follows:  
p-value $\le \alpha$, the hypothesis is **rejected** in favor of the alternative hypothesis.  
p-value $> \alpha$, the hypothesis is **not rejected** in favor of the alternative hypothesis.  

## System and Environment
This analysis was implemented using the 64 bit version of the R Programming Language, version 3.4.1. [@TheRFoundation2015] within the R. Studio Version 1.1.330 [@RStudioTeam2016] development environment on a Windows x64-based laptop powered by an Intel Core i7-3610QM CPU @ 2.30GHz, 2301 MHz processor with 4 Cores, 8 Logical Processors, and 16.0 GB of installed memory, running the Microsoft Windows 10 Home operating system, version	10.0.14393 Build 14393. Report writing and generation packages included knitr [@Xie2013], and kfigr [@Koohafkan2015].  Data management functionality was provided by the dplyr [Wickham2015a], reshape2 [@Rcpp2016], xtable [@Dahl2016] and data table [@Dowle2016] packages. Graphics and data visualization were powered by the ggplot2 [@Wickham2016], gridExtra [@BaptisteAuguie2016], and the stargazer [@Hlavac2015] packages.  The inference [@VinhNguyen2017] statistcal package provided functionality for extracting inferential values from a fitted model.

# Results 
This section begins with a univariate analysis of each variable, their categorical levels, sample sizes and proportions, in order to identify variables that may diverge from assumptions of independence and normality. The subsequent sections summarize the hypothesis testing for each research question.

## Univariate Analysis
The study variables, their categorical levels, numbers of complete cases, and response rates are summarized in `r kfigr::figr(label = "univariateSummary", prefix = TRUE, link = TRUE, type="Table")`. Preprocessing left `r uni$summary$Total[1]` total possible cases and variable response rates ranged from  `r uni$summary$Rate[6]`%  (`r uni$summary$Complete[6]` cases) to `r uni$summary$Rate[1]`% (`r uni$summary$Complete[1]` cases).

`r kfigr::figr(label = "univariateSummary", prefix = TRUE, link = TRUE, type="Table")`: Variable Summary
```{r univariateSummary, echo = F, message = FALSE, warning=FALSE}
knitr::kable(uni$summary) %>%  
  kableExtra::kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = T, position = "center")
```

Next, the variables in `r kfigr::figr(label = "univariateSummary", prefix = TRUE, link = TRUE, type="Table")` were examined in terms of:  
* **N**: The counts for each level of the categorical variable   
* **Minimum N**: The minimum sample size required to compute the population confidence interval with 95% confidence  
* **Proportion**: The proportional responses at each level of each categorical variable  
* **Cumulative**: The cumulative proportions  
* **Confidence Interval**: The 95% confidence interval for the population proportion at each categorical level   

### Degree
The Degree variable characterizes the respondents' education level in terms of highest degree earned. As indicated in `r kfigr::figr(label = "degreeData", prefix = TRUE, link = TRUE, type="Table")`, there were `r sum(uni$degree$data$N)` complete cases, with counts range = [`r min(uni$degree$data$N)`, `r max(uni$degree$data$N)`], and range of proportions = [`r min(uni$degree$data$Proportion)`, `r max(uni$degree$data$Proportion)`]. Minimum required sample sizes ranged from `r min(uni$degree$data[,3])` to `r max(uni$degree$data[,3])`, for a total of `r sum(uni$degree$data[,3])` observations. Since the minimum count thresholds were met at each categorical level, 95% confidence intervals for the population proportions were computed.

`r kfigr::figr(label = "degreeData", prefix = TRUE, link = TRUE, type="Table")`: Education variable descriptive statistics
```{r degreeData, include=T, echo = F, results='html'}
knitr::kable(uni$degree$data, digits = c(0,0,2,2,3,3,5), align = c("l", rep("c", 5))) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

```{r degreeBarplot, include=T, echo = F, results='html'}
uni$degree$barplot
``` 
`r kfigr::figr(label = "degreeBarplot", prefix = TRUE, link = TRUE, type="Figure")`: Education level proportions 

As graphically depicted in `r kfigr::figr(label = "degreeBarplot", prefix = TRUE, link = TRUE, type="Figure")` high school graduates comprised a near majority of the responses (`r round(max(uni$degree$data$Proportion) * 100, 0)`%), followed by under graduates (`r round(uni$degree$data$Proportion[4] * 100, 0)`%). Those with with less than high school degrees, those with graduate degrees, and respondents with junior college degrees made up `r round(uni$degree$data$Proportion[1] * 100, 0)`%, `r round(uni$degree$data$Proportion[5] * 100, 0)`%, and `r round(uni$degree$data$Proportion[3] * 100, 0)`%, respectively.

### Region
The Region variable indicates the geographic region in which the interview was conducted. As indicated in `r kfigr::figr(label = "regionData", prefix = TRUE, link = TRUE, type="Table")`, there were `r sum(uni$region$data$N)` complete cases, with counts range = [`r min(uni$region$data$N)`, `r max(uni$region$data$N)`], and range of proportions = [`r min(uni$region$data$Proportion)`, `r max(uni$region$data$Proportion)`]. Minimum required sample sizes ranged from `r min(uni$region$data[,3])` to `r max(uni$region$data[,3])`, for a total of `r sum(uni$region$data[,3])` observations. Since the minimum count thresholds were met at each categorical level, 95% confidence intervals for the population proportions were computed.

`r kfigr::figr(label = "regionData", prefix = TRUE, link = TRUE, type="Table")`: Region variable descriptive statistics
```{r regionData, include=T, echo = F, results='html'}
knitr::kable(uni$region$data, digits = c(0,0,2,2,3,3,5), align = c("l", rep("c", 5))) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

```{r regionBarplot, include=T, echo = F, results='html'}
uni$region$barplot
``` 
`r kfigr::figr(label = "regionBarplot", prefix = TRUE, link = TRUE, type="Figure")`: Region level proportions 

As graphically depicted in `r kfigr::figr(label = "regionBarplot", prefix = TRUE, link = TRUE, type="Figure")`, the Atlantic, Midwest, Mountain and Pacific regions constituted `r round(sum(uni$region$data$Proportion[1:3]) * 100, 0)`%, `r round(sum(uni$region$data$Proportion[4:5]) * 100, 0)`%, `r round(uni$region$data$Proportion[6] * 100, 0)`%, and `r round(uni$region$data$Proportion[7] * 100, 0)`% of the sample, respectively.

### Political Views
The Views variable characterizes a respondent as having either conservative, liberal or moderate political views. As indicated in `r kfigr::figr(label = "viewsData", prefix = TRUE, link = TRUE, type="Table")`, there were `r sum(uni$views$data$N)` complete cases, with counts range = [`r min(uni$views$data$N)`, `r max(uni$views$data$N)`], and range of proportions = [`r min(uni$views$data$Proportion)`, `r max(uni$views$data$Proportion)`]. Minimum required sample sizes ranged from `r min(uni$views$data[,3])` to `r max(uni$views$data[,3])`, for a total of `r sum(uni$views$data[,3])` observations. Since the minimum count thresholds were met at each categorical level, 95% confidence intervals for the population proportions were computed.

`r kfigr::figr(label = "viewsData", prefix = TRUE, link = TRUE, type="Table")`: Views variable descriptive statistics
```{r viewsData, include=T, echo = F, results='html'}
knitr::kable(uni$views$data, digits = c(0,0,2,2,3,3,5), align = c("l", rep("c", 5))) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

```{r viewsBarplot, include=T, echo = F, results='html'}
uni$views$barplot
``` 
`r kfigr::figr(label = "viewsBarplot", prefix = TRUE, link = TRUE, type="Figure")`: Responses by political view  

As graphically depicted in `r kfigr::figr(label = "viewsBarplot", prefix = TRUE, link = TRUE, type="Figure")`, the sample proportions of respondents with liberal, moderate, and conservative views were `r round(uni$views$data$Proportion[1] * 100, 0)`%, `r round(uni$views$data$Proportion[2] * 100, 0)`%, and `r round(uni$views$data$Proportion[3] * 100, 0)`%, respectively.

### Class
As indicated in `r kfigr::figr(label = "classData", prefix = TRUE, link = TRUE, type="Table")`, there are `r sum(uni$class$data$N)` complete cases, with counts range = [`r min(uni$class$data$N)`, `r max(uni$class$data$N)`], and range of proportions = [`r min(uni$class$data$Proportion)`, `r max(uni$class$data$Proportion)`]. Minimum required sample sizes ranged from `r min(uni$class$data[,3])` to `r max(uni$class$data[,3])`, for a total of `r sum(uni$class$data[,3])` observations. Since the minimum count thresholds were met at each categorical level, 95% confidence intervals for the population proportions were computed.

`r kfigr::figr(label = "classData", prefix = TRUE, link = TRUE, type="Table")`: Class variable descriptive statistics
```{r classData, include=T, echo = F, results='html'}
knitr::kable(uni$class$data, digits = c(0,0,2,2,3,3,5), align = c("l", rep("c", 5))) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

```{r classBarplot, include=T, echo = F, results='html'}
uni$class$barplot
``` 
`r kfigr::figr(label = "classBarplot", prefix = TRUE, link = TRUE, type="Figure")`: Responses by class  

As graphically depicted in `r kfigr::figr(label = "classBarplot", prefix = TRUE, link = TRUE, type="Figure")`, the vast majority of respondents (`r round(sum(uni$class$data$Proportion[2:3]) * 100, 0)`%) characterized themselves as working class or middle class.  

### Opinion
As indicated in `r kfigr::figr(label = "opinionData", prefix = TRUE, link = TRUE, type="Table")`, there were `r sum(uni$opinion$data$N)` complete cases, with counts range = [`r min(uni$opinion$data$N)`, `r max(uni$opinion$data$N)`], and range of proportions = [`r min(uni$opinion$data$Proportion)`, `r max(uni$opinion$data$Proportion)`]. Minimum required sample sizes ranged from `r min(uni$opinion$data[,3])` to `r max(uni$opinion$data[,3])`, for a total of `r sum(uni$opinion$data[,3])` observations. Since the minimum count thresholds were met at each categorical level, 95% confidence intervals for the population proportions were computed.

`r kfigr::figr(label = "opinionData", prefix = TRUE, link = TRUE, type="Table")`: Opinion variable descriptive statistics
```{r opinionData, include=T, echo = F, results='html'}
knitr::kable(uni$opinion$data, digits = c(0,0,2,2,3,3,5), align = c("l", rep("c", 5))) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

```{r opinionBarplot, include=T, echo = F, results='html'}
uni$opinion$barplot
``` 
`r kfigr::figr(label = "opinionBarplot", prefix = TRUE, link = TRUE, type="Figure")`: Responses by opinion  

As graphically depicted in `r kfigr::figr(label = "opinionBarplot", prefix = TRUE, link = TRUE, type="Figure")`, the vast majority of respondents (`r round(uni$opinion$data$Proportion[1] * 100, 0)`%) considered extra-marital sex as wrong. Approximately `r round(sum(uni$opinion$data$Proportion[2:3]) * 100, 0)`% of respondents considered extra-marital sex as sometimes wrong or not wrong at all.

### Behavior
As indicated in `r kfigr::figr(label = "behaviorData", prefix = TRUE, link = TRUE, type="Table")`, there were `r sum(uni$behavior$data$N)` complete cases, with counts range = [`r min(uni$behavior$data$N)`, `r max(uni$behavior$data$N)`], and range of proportions = [`r min(uni$behavior$data$Proportion)`, `r max(uni$behavior$data$Proportion)`]. Minimum required sample size was `r sum(uni$behavior$data[,3])` observations. Since the minimum count thresholds were met at each categorical level, 95% confidence intervals for the population proportions were computed.

`r kfigr::figr(label = "behaviorData", prefix = TRUE, link = TRUE, type="Table")`: Behavior variable descriptive statistics
```{r behaviorData, include=T, echo = F, results='html'}
knitr::kable(uni$behavior$data, digits = c(0,0,2,2,3,3,5), align = c("l", rep("c", 5))) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

```{r behaviorBarplot, include=T, echo = F, results='html'}
uni$behavior$barplot
``` 
`r kfigr::figr(label = "behaviorBarplot", prefix = TRUE, link = TRUE, type="Figure")`: Responses by behavior  

As graphically depicted in `r kfigr::figr(label = "behaviorBarplot", prefix = TRUE, link = TRUE, type="Figure")`, `r round(uni$behavior$data$Proportion[1] * 100, 0)`% of respondents have engaged in extra-marital sex behavior. 

The next section will evaluate the relationship between opinions and behaviors w.r.t. extra-marital conduct and the degree to which they are influenced by class, region, education and political views.

## Research Question #1: Opinions and Behaviors
This line of inquiry examines the relationship between opinions and behaviors w.r.t. extra-marital sex.

### The Data
The segmented bar chart in `r kfigr::figr(label = "rq1aPlot", prefix = TRUE, link = TRUE, type="Figure")` strongly suggests an association between opinions and behaviors with respect to extra-maritical conduct. Just `r rq1aData$data$propDf$Pct[2]`% of those with strong negative opinions reported extra-marital activity, versus `r rq1aData$data$propDf$Pct[4]`% of those with moderate opinions, and `r rq1aData$data$propDf$Pct[6]`% of those with relatively liberal positions on the matter.

```{r rq1aPlot, include=T, echo = F, results='html'}
rq1aData$plots$propBar
```
`r kfigr::figr(label = "rq1aPlot", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs Behavior Observed Frequencies and Proportions

`r kfigr::figr(label = "rq1aExpFreq", prefix = TRUE, link = TRUE, type="Table")` and `r kfigr::figr(label = "rq1aExpProp", prefix = TRUE, link = TRUE, type="Table")` contain the observed and expected frequencies, under the null hypothesis. The chi-squared test of association below verifies the statistical significance of the differences between the observed and expected frequencies. 

<div class = col2-left>
`r kfigr::figr(label = "rq1aExpFreq", prefix = TRUE, link = TRUE, type="Table")`: Opinion vs. Behavior Observed Frequency Table
```{r rq1aExpFreq, echo = F, results='html'}
knitr::kable(rq1aData$test$obsFreq, digits = 0, align = c("r", rep("c", 3))) %>%  
  kableExtra::add_header_above(c(" ", "Behavior" = 2, " ")) %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 
</div>

<div class = col2-right>
`r kfigr::figr(label = "rq1aExpProp", prefix = TRUE, link = TRUE, type="Table")`: Opinion vs. Behavior Expected Frequency Table 
```{r rq1aExpProp, echo = F, results='html'}
knitr::kable(rq1aData$test$expFreq, digits = 0, align = c("r", rep("c", 3))) %>%  
  kableExtra::add_header_above(c(" ", "Behavior" = 2, " ")) %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 
</div>

### Hypotheses
From this preliminary analysis, two sets of hypothesis were investigated: (1) does the segmented bar chart indicate a statistically significant association between behaviors and opinions w.r.t. extra-marital conduct, and (2) is their a significant difference in behaviors between those who considered extra-marital conduct as *sometimes wrong* and those who think that such conduct is *not wrong at all*.  

#### Hypothesis 1A: Association Between Behaviors and Opinions 
The hypotheses are formally stated as follows:  
$H_0$: The opinions and behaviors are independent, and therefore **no** association exists between opinions and behaviors w.r.t. extra-marital conduct.   
$H_a$: The two categorical variables are **not** independent, and therefore an association exists between opinions and behaviors w.r.t. extra-marital conduct.  

To evaluate the independence of opinions and behaviors, the **chi-square statistic** was selected. 

#### Inference Conditions
The conditions necessary for performing chi-square tests of independence were evaluated as follows:  
* **Independence:** Each observation was subject to a stratified random sampling and so **independence** was assumed.   
* **Sample Size:** As shown in the `r kfigr::figr(label = "rq1aExpFreq", prefix = TRUE, link = TRUE, type="Table")`, the minimum threshold of five expected counts for each cell was met.  Furthermore, the sample size was less than 10% of the population of U.S. adults age 18 and over.
* **Degrees of Freedom:** The degrees of freedom, $df$, must be at least two.  In this case, there were indeed `r rq1aData$test$table$Df` degrees of freedom.  
Consequently, the conditions for performing a chi-square test of independence were met.  

#### Test, Results and Interpretation
A chi-square test of independence was performed to examine the relation between opinion and behavior with respect to extra-marital conduct. `r kfigr::figr(label = "rq1aX2aPlot", prefix = TRUE, link = TRUE, type="Figure")` shows the chi-square distribution with the critical value, the reject region and observed statistic.  

```{r rq1aX2aPlot, include=T, echo = F, results='html'}
rq1aData$test$plot
```
`r kfigr::figr(label = "rq1aX2aPlot", prefix = TRUE, link = TRUE, type="Figure")`: Chi-Square Distribution

`r kfigr::figr(label = "rq1aX2a", prefix = TRUE, link = TRUE, type="Table")`: Opinion vs. Behavior Chi-Square Test of Association
```{r rq1aX2a, echo = F, results='html'}
knitr::kable(rq1aData$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

As indicated in `r kfigr::figr(label = "rq1aX2aPlot", prefix = TRUE, link = TRUE, type="Figure")` and confirmed in `r kfigr::figr(label = "rq1aX2a", prefix = TRUE, link = TRUE, type="Table")`, the association between these variables was significant, X2a (df = `r rq1aData$test$table$Df`, N = `r nrow(rq1aData$data$data)`) = `r round(rq1aData$test$table$X2a_Observed, 0)`, and $p \approx$ `r round(rq1aData$test$table$p_Value,3)`. As such, the $H_0$ is rejected in favor of $H_a$. **The data support an association between opinions and behaviors around extra-marital conduct.** 

#### Hypothesis 1B: Behaviors by Opinion 
Of particular interest was the statistical significance of the difference in behaviors between those who think extra-marital conduct is *sometimes wrong* and those who judged it *not wrong at all*.  

Let:  
$p_1$ indicate the proportion of the population that have engaged in extra-marital conduct and believe such conduct to be *sometimes wrong*. and   
$p_2$ indicate the proportion of the population that have engaged in extra-marital conduct and believe such conduct to be *not wrong at all*.

The hypotheses are formally stated as follows:  
$H_0$: $p_1 = p_2$   
$H_a$: $p_1 \neq p_2$   

For this set of hypotheses, both the z statistic and chi-square statistic were used to evaluate the equality of the two proportions. 

#### Inference Conditions
The conditions necessary for performing two-sample z-tests, and two-proportion chi-square tests were evaluated as follows:  
* **Independence:** Each observation was subject to a stratified random sampling and so **independence** was assumed.   
* **Success/Failure:** As shown in the `r kfigr::figr(label = "rq1aPlot", prefix = TRUE, link = TRUE, type="Figure")`, the minimum threshold of ten successes / failures per group and 5 counts per cell were met.
* **Sample Size:** The sample size was less than 10% of the population of U.S. adults age 18 and over.

Consequently, the conditions for performing the two-sample z-test and the two-proportion chi-square test were met.

#### Test, Results and Interpretation
As indicated in `r kfigr::figr(label = "rq1aPlot", prefix = TRUE, link = TRUE, type="Figure")`, `r rq1aData$data$propDf$Pct[4]`% of those who considered extra-marital conduct *sometimes wrong* engaged in extra-marital activities; whereas, `r rq1aData$data$propDf$Pct[6]`% of those who thought such conduct was *not wrong at all* engaged in such activites. Two-sample z-test for equality of proportions and a chi-square test for equality of proportions were conducted to determine the difference in the proportions of adults who engaged in extra-marital conduct between the two-groups (`r round((rq1aData$data$propDf$Pct[4] - rq1aData$data$propDf$Pct[6]) / 100, 3)`) was significant. The results of z-test (`r kfigr::figr(label = "rq1bZTest", prefix = TRUE, link = TRUE, type="Table")`) indicated that the difference in the proportions between the two groups was not significant (Z = `r round(rq1bData$z$Z.Score, 2)`, p-value =  `r round(rq1bData$z$p.value, 2)`).

`r kfigr::figr(label = "rq1bZTest", prefix = TRUE, link = TRUE, type="Table")`: Two-Sample Proportion Test
```{r rq1bZTest, echo = F, results='html'}
knitr::kable(rq1bData$z) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

Similarly the chi-square test for equality of proportions (`r kfigr::figr(label = "rq1bX2Test", prefix = TRUE, link = TRUE, type="Table")`) evidenced the statistical equality of the proportions ($X^2$ = `r round(rq1bData$x2$X2, 3)`, p-value =  `r round(rq1bData$x2$p.value, 2)`).

As a consequence of the high p-values of both tests, $H_0$ is not rejected.  The data does not support a difference in behavior between the two groups.

`r kfigr::figr(label = "rq1bX2Test", prefix = TRUE, link = TRUE, type="Table")`: Two-Sample Chi-Square Test
```{r rq1bX2Test, echo = F, results='html'}
knitr::kable(rq1bData$x2) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

## Research Question #2: Opinions and Demographics
This question investigates the relationship between opinions with respect to extra-marital conduct and geographic region, class, education and political view.

### Research Question #2a: Opinions and Geographics

#### Data

```{r rq2aData, include=T, echo = F, results='html'}
rq2Data$region$plots
```
`r kfigr::figr(label = "rq2aData", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs Region Observed Frequencies and Proportions

#### Hypotheses

#### Inference Conditions

#### Test, Results and Interpretation
```{r rq2aTestPlot, include=T, echo = F, results='html'}
rq2Data$region$test$plot
```
`r kfigr::figr(label = "rq2aTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs Region Test of Association Proportions


`r kfigr::figr(label = "rq2aTestData", prefix = TRUE, link = TRUE, type="Table")`: Opinions By Region Test of Association Plot
```{r rq2aTestData, echo = F, results='html'}
knitr::kable(rq2Data$region$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 


### Research Question #2b: Opinions and Class

#### Data

```{r rq2bData, include=T, echo = F, results='html'}
rq2Data$class$plots
```
`r kfigr::figr(label = "rq2bData", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs Class Observed Frequencies and Proportions

#### Hypotheses

#### Inference Conditions

#### Test, Results and Interpretation
```{r rq2bTestPlot, include=T, echo = F, results='html'}
rq2Data$class$test$plot
```
`r kfigr::figr(label = "rq2bTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs Class Test of Association Proportions


`r kfigr::figr(label = "rq2bTestData", prefix = TRUE, link = TRUE, type="Table")`: Opinions By Class Test of Association Plot
```{r rq2bTestData, echo = F, results='html'}
knitr::kable(rq2Data$class$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 


### Research Question #2c: Opinions and Education


#### Data

```{r rq2cData, include=T, echo = F, results='html'}
rq2Data$education$plots
```
`r kfigr::figr(label = "rq2cData", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs Education Observed Frequencies and Proportions

#### Hypotheses

#### Inference Conditions

#### Test, Results and Interpretation
```{r rq2cTestPlot, include=T, echo = F, results='html'}
rq2Data$education$test$plot
```
`r kfigr::figr(label = "rq2cTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs Education Test of Association Proportions


`r kfigr::figr(label = "rq2cTestData", prefix = TRUE, link = TRUE, type="Table")`: Opinions By Education Test of Association Plot
```{r rq2cTestData, echo = F, results='html'}
knitr::kable(rq2Data$education$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

### Research Question #2d: Opinions and Political Views


#### Data

```{r rq2dData, include=T, echo = F, results='html'}
rq2Data$view$plots
```
`r kfigr::figr(label = "rq2dData", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs View Observed Frequencies and Proportions

#### Hypotheses

#### Inference Conditions

#### Test, Results and Interpretation
```{r rq2dTestPlot, include=T, echo = F, results='html'}
rq2Data$view$test$plot
```
`r kfigr::figr(label = "rq2dTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Opinion vs Political View Test of Association Proportions


`r kfigr::figr(label = "rq2dTestData", prefix = TRUE, link = TRUE, type="Table")`: Opinions By Political View Test of Association Plot
```{r rq2dTestData, echo = F, results='html'}
knitr::kable(rq2Data$view$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 


## Research Question #3: Behaviors and Demographics
This question investigates the relationship between behaviors with respect to extra-marital conduct and geographic region, class, education and political view.

### Research Question #3a: Behaviors and Geographics

#### Data

```{r rq3aData, include=T, echo = F, results='html'}
rq3Data$region$plots
```
`r kfigr::figr(label = "rq3aData", prefix = TRUE, link = TRUE, type="Figure")`: Behavior vs Region Observed Frequencies and Proportions

#### Hypotheses

#### Inference Conditions

#### Test, Results and Interpretation
```{r rq3aTestPlot, include=T, echo = F, results='html'}
rq3Data$region$test$plot
```
`r kfigr::figr(label = "rq3aTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Behavior vs Region Test of Association Proportions


`r kfigr::figr(label = "rq3aTestData", prefix = TRUE, link = TRUE, type="Table")`: Behaviors By Region Test of Association Plot
```{r rq3aTestData, echo = F, results='html'}
knitr::kable(rq3Data$region$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 


### Research Question #3b: Behaviors and Class

#### Data

```{r rq3bData, include=T, echo = F, results='html'}
rq3Data$class$plots
```
`r kfigr::figr(label = "rq3bData", prefix = TRUE, link = TRUE, type="Figure")`: Behavior vs Class Observed Frequencies and Proportions

#### Hypotheses

#### Inference Conditions

#### Test, Results and Interpretation
```{r rq3bTestPlot, include=T, echo = F, results='html'}
rq3Data$class$test$plot
```
`r kfigr::figr(label = "rq3bTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Behavior vs Class Test of Association Proportions


`r kfigr::figr(label = "rq3bTestData", prefix = TRUE, link = TRUE, type="Table")`: Behaviors By Class Test of Association Plot
```{r rq3bTestData, echo = F, results='html'}
knitr::kable(rq3Data$class$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 


### Research Question #3c: Behaviors and Education


#### Data

```{r rq3cData, include=T, echo = F, results='html'}
rq3Data$education$plots
```
`r kfigr::figr(label = "rq3cData", prefix = TRUE, link = TRUE, type="Figure")`: Behavior vs Education Observed Frequencies and Proportions

#### Hypotheses

#### Inference Conditions

#### Test, Results and Interpretation
```{r rq3cTestPlot, include=T, echo = F, results='html'}
rq3Data$education$test$plot
```
`r kfigr::figr(label = "rq3cTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Behavior vs Education Test of Association Proportions


`r kfigr::figr(label = "rq3cTestData", prefix = TRUE, link = TRUE, type="Table")`: Behaviors By Education Test of Association Plot
```{r rq3cTestData, echo = F, results='html'}
knitr::kable(rq3Data$education$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 

### Research Question #3d: Behaviors and Political Views


#### Data

```{r rq3dData, include=T, echo = F, results='html'}
rq3Data$view$plots
```
`r kfigr::figr(label = "rq3dData", prefix = TRUE, link = TRUE, type="Figure")`: Behavior vs View Observed Frequencies and Proportions

#### Hypotheses

#### Inference Conditions

#### Test, Results and Interpretation
```{r rq3dTestPlot, include=T, echo = F, results='html'}
rq3Data$view$test$plot
```
`r kfigr::figr(label = "rq3dTestPlot", prefix = TRUE, link = TRUE, type="Figure")`: Behavior vs Political View Test of Association Proportions


`r kfigr::figr(label = "rq3dTestData", prefix = TRUE, link = TRUE, type="Table")`: Behaviors By Political View Test of Association Plot
```{r rq3dTestData, echo = F, results='html'}
knitr::kable(rq3Data$view$test$table) %>%  
  kableExtra::kable_styling(bootstrap_options = c("striped", "condensed"), full_width = T, position = "center")
``` 



# References
